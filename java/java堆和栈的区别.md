java程序在运行时都要开辟空间，任何软件在运行时都要在内存中开辟空间，java虚拟机运行时也要开辟空间。jvm运行时在内存中开辟一片内存区域，启动时在自己的内存区域中进行更细致的划分，因为虚拟机中每一片内存处理的方式都不同，所以要单独进行管理。划分为：寄存器、本地方法区、方法区、栈内存、堆内存。

## 栈内存
栈内存首先是一片内存区域，存储的都是局部变量，凡是定义在方法中的都是局部变量。for循环内部定义的也是局部变量，是先加载函数才能进行局部变量的定义。所以方法先进栈，然后再定变量，变量有自己的作用域，一旦离开作用域，变量就会被释放。栈内存的更新速度很快，因为局部变量的生命周期都很短。

## 堆内存
堆内存储的是数组和对象，凡是new建立的都在堆中。堆中存放的都是实体。堆内存不会随时释放，但是栈不一样，栈里存放的是单个变量，变量被释放就没有了。堆里的实体虽然不会被释放，但是会被当成垃圾，java有垃圾回收机制不定时的收取。

## 堆和栈的联系

    public static void main(String[] args){
        int[] arr=new int[3];
    }
分析上述代码：主函数先进栈，在栈中定义一个变量arr，接下来为arr赋值，但是右边不是一个具体值，而是一个实体。实体创建在堆里，在堆里首先通过new关键字开辟一个空间，在存在存储数据时都是通过地址来体现的。地址是一块连续的二进制，然后给这个实体分配一个内存地址。数组都是有一个索引，数组这个实体在堆内存中产生之后每一个空间都会进行默认初始化。堆内存的特点，未初始化的数据是不能用的。  
把堆的地址赋给arr，arr就通过地址指向了数组，所以arr想操作数组时，就通过地址，而不是直接把实体都赋给它。这种我们不再叫他基本类型，而叫他引用数据类型。称为arr引用了堆内存当中的实体。    
当arr=null，不作任何指向，null的作用就是取消引用数据类型指向。当一个实体，没有引用数据类型指向的时候,它在堆内存中不会被释放，而被当作一个垃圾，在不定时间内会自动回收，因为java有一个自动回收机制。

## 堆和栈的区别
* 栈内存存储的是局部变量，而堆内存存储的是实体
* 栈内存的更新速度要快于堆内存，因为局部变量的生命周期很短。
* 栈内存存放的变量生命周期一旦结束就会被释放，而堆内存存放的实体会被垃圾回收机制不定时的回收。

https://blog.csdn.net/pt666/article/details/70876410
